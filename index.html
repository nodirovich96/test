<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Telegram Mini App Test</title>
  <style>
    body { font-family: sans-serif; text-align: center; margin-top: 30px; }
    pre { text-align: left; display: inline-block; background: #f0f0f0; padding: 15px; border-radius: 8px; max-width: 90%; overflow-x: auto; }
  </style>
</head>
<body>
  <h1>Telegram Mini App Test</h1>
  <p id="status">Загрузка...</p>
  <pre id="rawdata"></pre>

  <script>
    // Проверка Telegram WebApp
    console.log("window.Telegram:", window.Telegram);
    console.log("window.Telegram.WebApp:", window.Telegram?.WebApp);

    const tg = window.Telegram?.WebApp;

    if (!tg) {
      document.getElementById("status").innerText = "❌ Не Telegram WebApp";
      document.getElementById("rawdata").innerText = "Откройте через кнопку бота на мобильном Telegram";
    } else {
      tg.ready(); // обязательно вызываем для Mini App

      // Raw initData и распарсенные данные
      const initDataRaw = tg.initData || null;
      const initDataUnsafe = tg.initDataUnsafe || {};

      document.getElementById("status").innerText = "✅ Telegram Mini App открыт";
      document.getElementById("rawdata").innerText = JSON.stringify({
        raw: initDataRaw,
        parsed: initDataUnsafe
      }, null, 2);

      console.log("Raw initData:", initDataRaw);
      console.log("Parsed initDataUnsafe:", initDataUnsafe);
    }
  </script>
</body>
</html>
